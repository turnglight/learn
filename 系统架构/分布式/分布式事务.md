
# 事务ACID

# 分布式事务
+ 服务多节点
+ 资源多节点

## CAP
+ C:一致性
+ A:可用性
+ P:分区容错性

> 熟悉CAP的人都知道，三者不能共有，如果感兴趣可以搜索CAP的证明，在分布式系统中，网络无法100%可靠，分区其实是一个必然现象，如果我们选择了CA而放弃了P，那么当发生分区现象时，为了保证一致性，这个时候必须拒绝请求，但是A又不允许，所以分布式系统理论上不可能选择CA架构，只能选择CP或者AP架构。

## BASE
BASE 是 Basically Available(基本可用)、Soft state(软状态)和 Eventually consistent (最终一致性)三个短语的缩写。是对CAP中AP的一个扩展

基本可用:分布式系统在出现故障时，允许损失部分可用功能，保证核心功能可用。
软状态:允许系统中存在中间状态，这个状态不影响系统可用性，这里指的是CAP中的不一致。
最终一致:最终一致是指经过一段时间后，所有节点数据都将会达到一致。

BASE解决了CAP中理论没有网络延迟，在BASE中用软状态和最终一致，保证了延迟后的一致性。BASE和 ACID 是相反的，它完全不同于ACID的强一致性模型，而是通过牺牲强一致性来获得可用性，并允许数据在一段时间内是不一致的，但最终达到一致状态。

# 分布式事务解决方案
## 2PC(两阶段提交)
+ 第一阶段：预处理
+ 第二阶段：等待第一阶段预处理成功，执行commit

## TCC（幂等性）
> try + confirm + cancel, 它同样是2pc两阶段提交衍生出来的。区别在于2pc主要的XA事务
> 协议主要是是在数据库层面实现的，比如oracle/mysql都实现了XA协议，它们对开发者是屏蔽
> 的;而TCC是在业务代码层面实现的，每一个阶段的实现都是由动作感知的。

+ try: 首先申请资源，并锁定资源；
    + 锁定资源：这里不是锁定整个资源，而是在业务逻辑层实现；当实现执行失败，对事务进行补偿。
+ confirm：确认提交，所有资源申请完成，进行提交；
+ cancel


## 本地消息表 & 异步化队列


## Seata


